function H(G,K,Q,U){if(!G&&!K)return;else if(!G)BG(K,Q,U);else if(!K)XG(G,Q,U);else if(G.type===2&&K.type===2)UG(G,K,U);else if(G.type===0&&K.type===0){if(K.key===G.key){K.child=G.child;return}I(G,K,Q,U)}else if(G.type===1&&K.type===1)if(K.tag===G.tag&&K.key===G.key)K.domRef=G.domRef,p(G,K,U);else I(G,K,Q,U);else I(G,K,Q,U)}function UG(G,K,Q){if(G.text!==K.text)Q.setTextContent(G.domRef,K.text);K.domRef=G.domRef;return}function B(G){if(!G.child)throw new Error("'drill' called on an unmounted Component. This should never happen, please make an issue.");switch(G.child.type){case 0:return B(G.child);default:return G.child.domRef}}function J(G){switch(G.type){case 0:return B(G);default:return G.domRef}}function I(G,K,Q,U){switch(G.type){case 2:break;default:R(G);break}switch(K.type){case 2:K.domRef=U.createTextNode(K.text),U.replaceChild(Q,K.domRef,J(G));break;case 0:M(Q,1,J(G),K,U);break;case 1:M(Q,1,J(G),K,U);break}switch(G.type){case 2:break;default:S(G);break}}function XG(G,K,Q){switch(G.type){case 2:break;default:R(G);break}switch(Q.removeChild(K,J(G)),G.type){case 2:break;default:S(G);break}}function S(G){switch(YG(G),G.type){case 1:for(let K of G.children)if(K.type===1||K.type===0)S(K);break;case 0:if(G.child){if(G.child.type===1||G.child.type===0)S(G.child)}break}}function YG(G){if(G.type===1&&G.onDestroyed)G.onDestroyed();if(G.type===0)JG(G)}function ZG(G){switch(G.type){case 0:if(G.onBeforeUnmounted)G.onBeforeUnmounted();break;case 1:if(G.onBeforeDestroyed)G.onBeforeDestroyed();break;default:break}}function R(G){switch(ZG(G),G.type){case 1:for(let K of G.children){if(K.type===2)continue;R(K)}break;case 0:if(G.child){if(G.child.type===1||G.child.type===0)R(G.child)}break}}function p(G,K,Q){$G(G?G.props:{},K.props,K.domRef,K.ns==="svg",Q),_G(G?G.classList:null,K.classList,K.domRef,Q),qG(G?G.css:{},K.css,K.domRef,Q),HG(G?G.children:[],K.children,K.domRef,Q),AG(K)}function _G(G,K,Q,U){if(!G&&!K)return;if(!G){for(let X of K)U.addClass(X,Q);return}if(!K){for(let X of G)U.removeClass(X,Q);return}for(let X of G)if(!K.has(X))U.removeClass(X,Q);for(let X of K)if(!G.has(X))U.addClass(X,Q);return}function $G(G,K,Q,U,X){var Z;for(let Y in G)if(Z=K[Y],Z===void 0)if(U||!(Y in Q)||Y==="disabled")X.removeAttribute(Q,Y);else X.setAttribute(Q,Y,"");else{if(Z===G[Y]&&Y!=="checked"&&Y!=="value")continue;if(U)if(Y==="href")X.setAttributeNS(Q,"http://www.w3.org/1999/xlink","href",Z);else X.setAttribute(Q,Y,Z);else if(Y in Q&&!(Y==="list"||Y==="form"))Q[Y]=Z;else X.setAttribute(Q,Y,Z)}for(let Y in K){if(G&&G[Y])continue;if(Z=K[Y],U)if(Y==="href")X.setAttributeNS(Q,"http://www.w3.org/1999/xlink","href",Z);else X.setAttribute(Q,Y,Z);else if(Y in Q&&!(Y==="list"||Y==="form"))Q[Y]=K[Y];else X.setAttribute(Q,Y,Z)}}function qG(G,K,Q,U){U.setInlineStyle(G,K,Q)}function zG(G,K){if(G.length===0||K.length===0)return!1;for(var Q=0;Q<G.length;Q++)if(G[Q].key===null||G[Q].key===void 0)return!1;for(var Q=0;Q<K.length;Q++)if(K[Q].key===null||K[Q].key===void 0)return!1;return!0}function HG(G,K,Q,U){if(zG(G,K))DG(G,K,Q,U);else for(let X=0;X<Math.max(K.length,G.length);X++)H(G[X],K[X],Q,U)}function WG(G,K){if(G.ns==="svg")G.domRef=K.createElementNS("http://www.w3.org/2000/svg",G.tag);else if(G.ns==="mathml")G.domRef=K.createElementNS("http://www.w3.org/1998/Math/MathML",G.tag);else G.domRef=K.createElement(G.tag)}function P(G,K,Q){switch(K.type){case 0:a(G,0,null,K,Q);break;case 1:if(K.onCreated)K.onCreated(K.domRef);break}}function M(G,K,Q,U,X){switch(U.type){case 2:switch(U.domRef=X.createTextNode(U.text),K){case 2:X.insertBefore(G,U.domRef,Q);break;case 0:X.appendChild(G,U.domRef);break;case 1:X.replaceChild(G,U.domRef,Q);break}break;case 0:a(G,K,Q,U,X);break;case 1:if(U.onBeforeCreated)U.onBeforeCreated();if(WG(U,X),U.onCreated)U.onCreated(U.domRef);switch(p(null,U,X),K){case 2:X.insertBefore(G,U.domRef,Q);break;case 0:X.appendChild(G,U.domRef);break;case 1:X.replaceChild(G,U.domRef,Q);break}break}}function AG(G){if(G.tag==="canvas"&&G.draw)G.draw(G.domRef)}function JG(G){if(G.onUnmounted)G.onUnmounted(B(G));G.unmount(G.componentId)}function a(G,K,Q,U,X){if(U.onBeforeMounted)U.onBeforeMounted();if(U.mount(G,(Z,Y)=>{if(U.componentId=Z,U.child=Y,Y.parent=U,Y.type!==0){let _=J(Y);if(K===1&&Q)X.replaceChild(G,_,Q);else if(K===2)X.insertBefore(G,_,Q)}}),U.onMounted)U.onMounted(B(U))}function BG(G,K,Q){if(G.type===2)G.domRef=Q.createTextNode(G.text),Q.appendChild(K,G.domRef);else M(K,0,null,G,Q)}function D(G,K,Q,U){U.insertBefore(G,J(K),Q?J(Q):null)}function EG(G,K,Q){Q.removeChild(G,J(K))}function NG(G,K,Q,U){U.swapDOMRefs(J(G),J(K),Q)}function DG(G,K,Q,U){var X=0,Z=0,Y=G.length-1,_=K.length-1,z,q,$,W,A,L,d;for(;;){if(Z>_&&X>Y)break;if(q=K[Z],$=K[_],A=G[X],W=G[Y],X>Y)H(null,q,Q,U),D(Q,q,A,U),G.splice(Z,0,q),Z++;else if(Z>_){z=Y;while(Y>=X)EG(Q,G[Y--],U);G.splice(X,z-X+1);break}else if(A.key===q.key)H(G[X++],K[Z++],Q,U);else if(W.key===$.key)H(G[Y--],K[_--],Q,U);else if(A.key===$.key&&q.key===W.key)NG(W,A,Q,U),SG(G,X,Y),H(G[X++],K[Z++],Q,U),H(G[Y--],K[_--],Q,U);else if(A.key===$.key)D(Q,A,W.nextSibling,U),G.splice(Y,0,G.splice(X,1)[0]),H(G[Y--],K[_--],Q,U);else if(W.key===q.key)D(Q,W,A,U),G.splice(X,0,G.splice(Y,1)[0]),H(G[X++],q,Q,U),Z++;else{L=!1,z=X;while(z<=Y){if(G[z].key===q.key){L=!0,d=G[z];break}z++}if(L)G.splice(X,0,G.splice(z,1)[0]),H(G[X++],q,Q,U),D(Q,d,G[X],U),Z++;else M(Q,2,J(A),q,U),G.splice(X++,0,q),Z++,Y++}}}function SG(G,K,Q){let U=G[K];G[K]=G[Q],G[Q]=U}function w(G,K,Q,U,X){for(let Z of K)X.addEventListener(G,Z.name,function(Y){c(Y,G,Q,U,X)},Z.capture)}function V(G,K,Q,U,X){for(let Z of K)X.removeEventListener(G,Z.name,function(Y){c(Y,G,Q,U,X)},Z.capture)}function c(G,K,Q,U,X){Q(function(Z){if(Array.isArray(G))for(let Y of G)s(Y,Z,K,U,X);else s(G,Z,K,U,X)})}function s(G,K,Q,U,X){var Z=X.getTarget(G);if(Z){let Y=RG(Q,Z,X);E(G,K,Y,U,X)}}function RG(G,K,Q){var U=[];while(!Q.isEqual(G,K))if(U.unshift(K),K&&Q.parentNode(K))K=Q.parentNode(K);else return U;return U}function E(G,K,Q,U,X){if(!Q.length){if(U)console.warn('Event "'+G.type+'" did not find an event handler to dispatch on',K,G);return}else if(Q.length>1){if(K.type===2)return;else if(K.type===0){if(!K.child){if(U)throw console.error("VComp has no child property set during event delegation",K),console.error("This means the Component has not been fully mounted, this should never happen"),new Error("VComp has no .child property set during event delegation");return}return E(G,K.child,Q,U,X)}else if(K.type===1){if(X.isEqual(K.domRef,Q[0])){let Z=K.events.captures[G.type];if(Z){let Y=Z.options;if(Y.preventDefault)G.preventDefault();if(!G.captureStopped)Z.runEvent(G,K.domRef);if(Y.stopPropagation)G.captureStopped=!0}Q.splice(0,1)}for(let Z of K.children)if(Z.type===0){let Y=B(Z);if(Y&&X.isEqual(Y,Q[0]))E(G,Z,Q,U,X)}else if(Z.type===1){if(X.isEqual(Z.domRef,Q[0]))E(G,Z,Q,U,X)}}}else if(K.type===0){if(K.child)E(G,K.child,Q,U,X)}else if(K.type===1){let Z=K.events.captures[G.type];if(Z&&!G.captureStopped){let _=Z.options;if(X.isEqual(Q[0],K.domRef)){if(_.preventDefault)G.preventDefault();if(Z.runEvent(G,Q[0]),_.stopPropagation)G.captureStopped=!0}}let Y=K.events.bubbles[G.type];if(Y&&!G.captureStopped){let _=Y.options;if(X.isEqual(Q[0],K.domRef)){if(_.preventDefault)G.preventDefault();if(Y.runEvent(G,Q[0]),!_.stopPropagation)r(K.parent,G)}}else if(!G.captureStopped)r(K.parent,G)}}function r(G,K){while(G)switch(G.type){case 2:break;case 1:let Q=G.events.bubbles[K.type];if(Q){let U=Q.options;if(U.preventDefault)K.preventDefault();if(Q.runEvent(K,G.domRef),U.stopPropagation)return}G=G.parent;break;case 0:if(!G.eventPropagation)return;G=G.parent;break}}function N(G,K){if(typeof G[0]==="object"){var Q=[];for(var U=0;U<G.length;U++)Q.push(N(G[U],K));return Q}for(let _ of G)K=K[_];var X;if(K instanceof Array||"length"in K&&K.localName!=="select"){X=[];for(var Z=0;Z<K.length;Z++)X.push(N([],K[Z]));return X}X={};for(var Y in MG(K)){if(K.localName==="input"&&(Y==="selectionDirection"||Y==="selectionStart"||Y==="selectionEnd"))continue;if(typeof K[Y]=="string"||typeof K[Y]=="number"||typeof K[Y]=="boolean")X[Y]=K[Y]}return X}function MG(G){var K={},Q=0;do{var U=Object.getOwnPropertyNames(G);for(Q=0;Q<U.length;Q++)K[U[Q]]=null}while(G=Object.getPrototypeOf(G));return K}function FG(G){var K=0,Q=G.length>0?[G[0]]:[];for(var U=1;U<G.length;U++){if(Q[K].type===2&&G[U].type===2){Q[K].text+=G[U].text;continue}Q[++K]=G[U]}return Q}function LG(G,K){var Q=0,U,X=K.getRoot();if(!G)if(X.childNodes.length>0)U=X.firstChild;else U=X.appendChild(K.createElement("div"));else if(G.childNodes.length===0)U=G.appendChild(K.createElement("div"));else{while(G.childNodes[Q]&&(G.childNodes[Q].nodeType===3||G.childNodes[Q].localName==="script"))Q++;if(!G.childNodes[Q])U=X.appendChild(K.createElement("div"));else U=G.childNodes[Q]}return U}function C(G,K,Q,U,X){let Z=LG(K,X);if(!t(G,Q,Z,U,X)){if(G)console.warn("[DEBUG_HYDRATE] Could not copy DOM into virtual DOM, falling back to diff");while(U.firstChild(Z))X.removeChild(Z,U.lastChild(Z));return H(null,Q,Z,X),!1}else if(G)console.info("[DEBUG_HYDRATE] Successfully prerendered page");return!0}function O(G,K,Q){if(G)console.warn("[DEBUG_HYDRATE] VTree differed from node",K,Q)}function o(G){if(G.substr(0,1)=="#"){let K=(G.length-1)/3,Q=[17,1,0.062272][K-1];return[Math.round(parseInt(G.substr(1,K),16)*Q),Math.round(parseInt(G.substr(1+K,K),16)*Q),Math.round(parseInt(G.substr(1+2*K,K),16)*Q)]}else return G.split("(")[1].split(")")[0].split(",").map((K)=>{return+K})}function f(G,K,Q){return n(!0,G,K,Q)}function n(G,K,Q,U){if(K.type==2){if(Q.getTag(K.domRef)!=="#text")console.warn("VText domRef not a TEXT_NODE",K),G=!1;else if(K.text!==Q.getTextContent(K.domRef))console.warn("VText node content differs",K),G=!1}else if(K.type===1){if(K.tag.toUpperCase()!==Q.getTag(K.domRef).toUpperCase())console.warn("Integrity check failed, tags differ",K.tag.toUpperCase(),Q.getTag(K.domRef)),G=!1;if("children"in K&&K.children.length!==Q.children(K.domRef).length)console.warn("Integrity check failed, children lengths differ",K,K.children,Q.children(K.domRef)),G=!1;for(let X in K.props)if(X==="href"||X==="src"){let Z=window.location.origin+"/"+K.props[X],Y=Q.getAttribute(K.domRef,X),_=K.props[X];if(Z!==Y&&_!==Y&&_+"/"!==Y&&Z+"/"!==Y)console.warn("Property "+X+" differs",K.props[X],Q.getAttribute(K.domRef,X)),G=!1}else if(X==="height"||X==="width"){if(parseFloat(K.props[X])!==parseFloat(Q.getAttribute(K.domRef,X)))console.warn("Property "+X+" differs",K.props[X],Q.getAttribute(K.domRef,X)),G=!1}else if(X==="class"||X==="className"){if(K.props[X]!==Q.getAttribute(K.domRef,"class"))console.warn("Property class differs",K.props[X],Q.getAttribute(K.domRef,"class")),G=!1}else if(K.props[X]!==Q.getAttribute(K.domRef,X))console.warn("Property "+X+" differs",K.props[X],Q.getAttribute(K.domRef,X)),G=!1;for(let X in K.css)if(X==="color"){if(o(Q.getInlineStyle(K.domRef,X)).toString()!==o(K.css[X]).toString())console.warn("Style "+X+" differs",K.css[X],Q.getInlineStyle(K.domRef,X)),G=!1}else if(K.css[X]!==Q.getInlineStyle(K.domRef,X))console.warn("Style "+X+" differs",K.css[X],Q.getInlineStyle(K.domRef,X)),G=!1;for(let X of K.children){let Z=n(G,X,Q,U);G=G&&Z}}return G}function t(G,K,Q,U,X){switch(K.type){case 0:P(Q,K,X);break;case 2:K.domRef=Q;break;case 1:K.domRef=Q,K.children=FG(K.children),P(Q,K,X);for(var Z=0;Z<K.children.length;Z++){let Y=K.children[Z],_=Q.childNodes[Z];if(!_)return O(G,Y,_),!1;switch(Y.type){case 2:if(_.nodeType!==3)return O(G,Y,_),!1;if(Y.text===_.textContent)Y.domRef=U.children(Q)[Z];else return O(G,Y,_),!1;break;default:if(_.nodeType!==1)return!1;t(G,Y,_,U,X);break}}}return!0}var j="1.9.0.0";function k(G,K){var Q=function(){var U=document.getElementById(G);if(U&&U.focus)U.focus()};K>0?setTimeout(Q,K):Q()}function b(G,K){var Q=function(){var U=document.getElementById(G);if(U&&U.blur)U.blur()};K>0?setTimeout(Q,K):Q()}function T(G,K){var Q=function(){var U=document.getElementById(G);if(U&&typeof U.select==="function")U.select()};K>0?setTimeout(Q,K):Q()}function h(G,K,Q,U){var X=function(){var Z=document.getElementById(G);if(Z&&typeof Z.setSelectionRange==="function")Z.setSelectionRange(K,Q,"none")};U>0?setTimeout(X,U):X()}function g(G,K,Q,U,X,Z,Y){var _={method:K,headers:U};if(Q)_.body=Q;let z={},q=null;try{fetch(G,_).then(($)=>{q=$.status;for(let[W,A]of $.headers)z[W]=A;if(!$.ok)throw new Error($.statusText);if(Y=="json")return $.json();else if(Y=="text")return $.text();else if(Y==="arrayBuffer")return $.arrayBuffer();else if(Y==="blob")return $.blob();else if(Y==="bytes")return $.bytes();else if(Y==="formData")return $.formData();else if(Y==="none")return X({error:null,body:null,headers:z,status:q})}).then(($)=>X({error:null,body:$,headers:z,status:q})).catch(($)=>Z({error:null,body:$,headers:z,status:q}))}catch($){Z({body:null,error:$.message,headers:z,status:q})}}function u(G){var K=function(Q){let U=null;while(Q&&Q.parentNode){if("componentId"in Q.parentNode){U=Q.parentNode.componentId;break}Q=Q.parentNode}return U};return K(G)}function y(G,K,Q,U,X,Z,Y,_,z){try{let q=new WebSocket(G);return q.onopen=function(){K()},q.onclose=function($){Q($)},q.onerror=function($){console.error($),_("WebSocket error received")},q.onmessage=function($){if(typeof $.data==="string")try{if(z){if(U)U($.data);return}let W=JSON.parse($.data);if(X)X(W)}catch(W){if(z&&U)U($.data);else _(W.message)}else if($.data instanceof Blob){if(Z)Z($.data)}else if($.data instanceof ArrayBuffer){if(Y)Y($.data)}else console.error("Received unknown message type from WebSocket",$),_("Unknown message received from WebSocket")},q}catch(q){_(q.message)}}function m(G){if(G)G.close(),G=null}function v(G,K){if(K&&G&&G.readyState===WebSocket.OPEN)G.send(K)}function i(G,K,Q,U,X,Z){try{let Y=new EventSource(G);return Y.onopen=function(){K()},Y.onerror=function(){X("EventSource error received")},Y.onmessage=function(_){try{if(Z){if(Q)Q(_.data);return}let z=JSON.parse(_.data);if(U)U(z)}catch(z){if(Z&&Q)Q(_.data);else X(z.message)}},Y}catch(Y){X(Y.message)}}function l(G){if(G)G.close(),G=null}function x(G,K){if(!G.classList)G.classList=new Set;for(let Q of K)for(let U of Q.trim().split(" "))if(U)G.classList.add(U)}var e={addEventListener:(G,K,Q,U)=>{G.addEventListener(K,Q,U)},removeEventListener:(G,K,Q,U)=>{G.removeEventListener(K,Q,U)},isEqual:(G,K)=>{return G===K},getTarget:(G)=>{return G.target},parentNode:(G)=>{return G.parentNode}},GG={getInlineStyle:(G,K)=>{return G.style[K]},firstChild:(G)=>{return G.firstChild},lastChild:(G)=>{return G.lastChild},getAttribute:(G,K)=>{if(K==="class")return G.className;if(K in G)return G[K];return G.getAttribute(K)},getTag:(G)=>{return G.nodeName},getTextContent:(G)=>{return G.textContent},children:(G)=>{return G.childNodes}},KG={mountComponent:function(G,K,Q){return},unmountComponent:function(G){return},modelHydration:function(G){return}},QG={nextSibling:(G)=>{if(G.nextSibling)switch(G.nextSibling.type){case 0:return B(G.nextSibling);default:return G.nextSibling.domRef}return null},createTextNode:(G)=>{return document.createTextNode(G)},createElementNS:(G,K)=>{return document.createElementNS(G,K)},appendChild:(G,K)=>{return G.appendChild(K)},replaceChild:(G,K,Q)=>{return G.replaceChild(K,Q)},removeChild:(G,K)=>{return G.removeChild(K)},createElement:(G)=>{return document.createElement(G)},addClass:(G,K)=>{if(G)K.classList.add(G)},removeClass:(G,K)=>{if(G)K.classList.remove(G)},insertBefore:(G,K,Q)=>{return G.insertBefore(K,Q)},swapDOMRefs:(G,K,Q)=>{let U=G.nextSibling;Q.insertBefore(G,K),Q.insertBefore(K,U);return},setInlineStyle:(G,K,Q)=>{var U;for(let X in G)if(U=K[X],!U)if(X in Q.style)Q.style[X]="";else Q.style.setProperty(X,"");else if(U!==G[X])if(X in Q.style)Q.style[X]=U;else Q.style.setProperty(X,U);for(let X in K){if(G&&G[X])continue;if(X in Q.style)Q.style[X]=K[X];else Q.style.setProperty(X,K[X])}return},setAttribute:(G,K,Q)=>{return G.setAttribute(K,Q)},setAttributeNS:(G,K,Q,U)=>{return G.setAttributeNS(K,Q,U)},removeAttribute:(G,K)=>{return G.removeAttribute(K)},setTextContent:(G,K)=>{G.textContent=K;return},flush:()=>{return},getRoot:function(){return document.body}};globalThis.miso={hydrationContext:GG,eventContext:e,drawingContext:QG,componentContext:KG,diff:H,hydrate:C,version:j,delegate:w,callBlur:b,callFocus:k,callSelect:T,callSetSelectionRange:h,eventJSON:N,fetchCore:g,eventSourceConnect:i,eventSourceClose:l,websocketConnect:y,websocketClose:m,websocketSend:v,undelegate:V,populateClass:x,getParentComponentId:u,integrityCheck:f,setDrawingContext:function(G){let K=globalThis[G].drawingContext,Q=globalThis[G].eventContext;if(!K)console.error('Custom rendering engine ("drawingContext") is not defined at globalThis[name].drawingContext',G);if(!Q)console.error('Custom event delegation ("eventContext") is not defined at globalThis[name].eventContext',G);globalThis.miso.drawingContext=K,globalThis.miso.eventContext=Q}};
