function W(z,G,K,U){if(!z&&!G)return;else if(!z)Nz(G,K,U);else if(!G)r(z,K,U);else if(z.type===2&&G.type===2)Yz(z,G,U);else if(z.type===0&&G.type===0){if(G.key===z.key){if(G.child=z.child,G.componentId=z.componentId,z.child)z.child.parent=G;return}F(z,G,K,U)}else if(z.type===1&&G.type===1)if(G.tag===z.tag&&G.key===z.key)G.domRef=z.domRef,o(z,G,U);else F(z,G,K,U);else F(z,G,K,U)}function Yz(z,G,K){if(z.text!==G.text)K.setTextContent(z.domRef,G.text);G.domRef=z.domRef;return}function M(z){if(!z.child)throw new Error("'drill' called on an unmounted Component. This should never happen, please make an issue.");switch(z.child.type){case 0:return M(z.child);default:return z.child.domRef}}function J(z){switch(z.type){case 0:return M(z);default:return z.domRef}}function F(z,G,K,U){switch(z.type){case 2:break;default:S(z);break}switch(C(K,1,J(z),G,U),z.type){case 2:break;default:N(z);break}}function r(z,G,K){switch(z.type){case 2:break;default:S(z);break}switch(K.removeChild(G,J(z)),z.type){case 2:break;default:N(z);break}}function N(z){switch(Zz(z),z.type){case 1:for(let G of z.children)if(G.type===1||G.type===0)N(G);break;case 0:if(z.child){if(z.child.type===1||z.child.type===0)N(z.child)}break}}function Zz(z){if(z.type===1&&z.onDestroyed)z.onDestroyed();if(z.type===0)Bz(z)}function $z(z){switch(z.type){case 0:break;case 1:if(z.onBeforeDestroyed)z.onBeforeDestroyed();break;default:break}}function S(z){switch($z(z),z.type){case 1:for(let G of z.children){if(G.type===2)continue;S(G)}break;case 0:if(z.child){if(z.child.type===1||z.child.type===0)S(z.child)}break}}function o(z,G,K){Hz(z?z.props:{},G.props,G.domRef,G.ns==="svg",K),qz(z?z.classList:null,G.classList,G.domRef,K),_z(z?z.css:{},G.css,G.domRef,K),Az(z?z.children:[],G.children,G.domRef,K),Ez(G)}function qz(z,G,K,U){if(!z&&!G)return;if(!z){for(let Q of G)U.addClass(Q,K);return}if(!G){for(let Q of z)U.removeClass(Q,K);return}for(let Q of z)if(!G.has(Q))U.removeClass(Q,K);for(let Q of G)if(!z.has(Q))U.addClass(Q,K);return}function Hz(z,G,K,U,Q){var Y;for(let X in z)if(Y=G[X],Y===void 0)if(U||!(X in K)||X==="disabled")Q.removeAttribute(K,X);else Q.setAttribute(K,X,"");else{if(Y===z[X]&&X!=="checked"&&X!=="value")continue;if(U)if(X==="href")Q.setAttributeNS(K,"http://www.w3.org/1999/xlink","href",Y);else Q.setAttribute(K,X,Y);else if(X in K&&!(X==="list"||X==="form"))K[X]=Y;else Q.setAttribute(K,X,Y)}for(let X in G){if(z&&z[X])continue;if(Y=G[X],U)if(X==="href")Q.setAttributeNS(K,"http://www.w3.org/1999/xlink","href",Y);else Q.setAttribute(K,X,Y);else if(X in K&&!(X==="list"||X==="form"))K[X]=G[X];else Q.setAttribute(K,X,Y)}}function _z(z,G,K,U){U.setInlineStyle(z,G,K)}function Wz(z,G){if(z.length===0||G.length===0)return!1;for(var K=0;K<z.length;K++)if(z[K].key===null||z[K].key===void 0)return!1;for(var K=0;K<G.length;K++)if(G[K].key===null||G[K].key===void 0)return!1;return!0}function Az(z,G,K,U){if(Wz(z,G))Rz(z,G,K,U);else for(let Q=0;Q<Math.max(G.length,z.length);Q++)W(z[Q],G[Q],K,U)}function Jz(z,G){if(z.ns==="svg")z.domRef=G.createElementNS("http://www.w3.org/2000/svg",z.tag);else if(z.ns==="mathml")z.domRef=G.createElementNS("http://www.w3.org/1998/Math/MathML",z.tag);else z.domRef=G.createElement(z.tag)}function n(z,G,K){if(G.onCreated)G.onCreated(G.domRef)}function C(z,G,K,U,Q){switch(U.type){case 2:switch(U.domRef=Q.createTextNode(U.text),G){case 2:Q.insertBefore(z,U.domRef,K);break;case 0:Q.appendChild(z,U.domRef);break;case 1:Q.replaceChild(z,U.domRef,K);break}break;case 0:Dz(z,G,K,U,Q);break;case 1:if(U.onBeforeCreated)U.onBeforeCreated();if(Jz(U,Q),U.onCreated)U.onCreated(U.domRef);switch(o(null,U,Q),G){case 2:Q.insertBefore(z,U.domRef,K);break;case 0:Q.appendChild(z,U.domRef);break;case 1:Q.replaceChild(z,U.domRef,K);break}break}}function Ez(z){if(z.tag==="canvas"&&z.draw)z.draw(z.domRef)}function Bz(z){z.unmount(z.componentId)}function Dz(z,G,K,U,Q){let Y=U.mount(z);if(U.componentId=Y.componentId,U.child=Y.componentTree,Y.componentTree.parent=U,Y.componentTree.type!==0){let X=J(Y.componentTree);if(G===1&&K)Q.replaceChild(z,X,K);else if(G===2)Q.insertBefore(z,X,K)}}function Nz(z,G,K){C(G,0,null,z,K)}function D(z,G,K,U){U.insertBefore(z,J(G),K?J(K):null)}function Sz(z,G,K,U){U.swapDOMRefs(J(z),J(G),K)}function Rz(z,G,K,U){var Q=0,Y=0,X=z.length-1,$=G.length-1,H,q,Z,_,A,I,c;for(;;){if(Y>$&&Q>X)break;if(q=G[Y],Z=G[$],A=z[Q],_=z[X],Q>X)W(null,q,K,U),D(K,q,A,U),z.splice(Y,0,q),Y++;else if(Y>$){H=X;while(X>=Q)r(z[X--],K,U);z.splice(Q,H-Q+1);break}else if(A.key===q.key)W(z[Q++],G[Y++],K,U);else if(_.key===Z.key)W(z[X--],G[$--],K,U);else if(A.key===Z.key&&q.key===_.key)Sz(_,A,K,U),Mz(z,Q,X),W(z[Q++],G[Y++],K,U),W(z[X--],G[$--],K,U);else if(A.key===Z.key)D(K,A,_.nextSibling,U),z.splice(X,0,z.splice(Q,1)[0]),W(z[X--],G[$--],K,U);else if(_.key===q.key)D(K,_,A,U),z.splice(Q,0,z.splice(X,1)[0]),W(z[Q++],q,K,U),Y++;else{I=!1,H=Q;while(H<=X){if(z[H].key===q.key){I=!0,c=z[H];break}H++}if(I)z.splice(Q,0,z.splice(H,1)[0]),W(z[Q++],q,K,U),D(K,c,z[Q],U),Y++;else C(K,2,J(A),q,U),z.splice(Q++,0,q),Y++,X++}}}function Mz(z,G,K){let U=z[G];z[G]=z[K],z[K]=U}function zz(z,G,K,U,Q){for(let Y of G)Q.addEventListener(z,Y.name,function(X){Iz(X,z,K,U,Q)},Y.capture)}function Iz(z,G,K,U,Q){K(function(Y){if(Array.isArray(z))for(let X of z)t(X,Y,G,U,Q);else t(z,Y,G,U,Q)})}function t(z,G,K,U,Q){var Y=Q.getTarget(z);if(Y){let X=Fz(K,Y,Q);E(z,G,X,U,Q)}}function Fz(z,G,K){var U=[];while(!K.isEqual(z,G))if(U.unshift(G),G&&K.parentNode(G))G=K.parentNode(G);else return U;return U}function E(z,G,K,U,Q){if(!K.length){if(U)console.warn('Event "'+z.type+'" did not find an event handler to dispatch on',G,z);return}else if(K.length>1){if(G.type===2)return;else if(G.type===0){if(!G.child){if(U)throw console.error("VComp has no child property set during event delegation",G),console.error("This means the Component has not been fully mounted, this should never happen"),new Error("VComp has no .child property set during event delegation");return}return E(z,G.child,K,U,Q)}else if(G.type===1){if(Q.isEqual(G.domRef,K[0])){let Y=G.events.captures[z.type];if(Y){let X=Y.options;if(X.preventDefault)z.preventDefault();if(!z.captureStopped)Y.runEvent(z,G.domRef);if(X.stopPropagation)z.captureStopped=!0}K.splice(0,1);for(let X of G.children)if(Q.isEqual(J(X),K[0]))E(z,X,K,U,Q)}return}}else if(G.type===0){if(G.child)E(z,G.child,K,U,Q)}else if(G.type===1){let Y=G.events.captures[z.type];if(Y&&!z.captureStopped){let $=Y.options;if(Q.isEqual(K[0],G.domRef)){if($.preventDefault)z.preventDefault();if(Y.runEvent(z,K[0]),$.stopPropagation)z.captureStopped=!0}}let X=G.events.bubbles[z.type];if(X&&!z.captureStopped){let $=X.options;if(Q.isEqual(K[0],G.domRef)){if($.preventDefault)z.preventDefault();if(X.runEvent(z,K[0]),!$.stopPropagation)e(G.parent,z)}}else if(!z.captureStopped)e(G.parent,z)}}function e(z,G){while(z)switch(z.type){case 2:break;case 1:let K=z.events.bubbles[G.type];if(K){let U=K.options;if(U.preventDefault)G.preventDefault();if(K.runEvent(G,z.domRef),U.stopPropagation)return}z=z.parent;break;case 0:if(!z.eventPropagation)return;z=z.parent;break}}function B(z,G){if(typeof z[0]==="object"){var K=[];for(var U=0;U<z.length;U++)K.push(B(z[U],G));return K}for(let $ of z)G=G[$];var Q;if(G instanceof Array||"length"in G&&G.localName!=="select"){Q=[];for(var Y=0;Y<G.length;Y++)Q.push(B([],G[Y]));return Q}Q={};for(var X in Cz(G)){if(G.localName==="input"&&(X==="selectionDirection"||X==="selectionStart"||X==="selectionEnd"))continue;if(typeof G[X]=="string"||typeof G[X]=="number"||typeof G[X]=="boolean")Q[X]=G[X]}return Q}function Cz(z){var G={},K=0;do{var U=Object.getOwnPropertyNames(z);for(K=0;K<U.length;K++)G[U[K]]=null}while(z=Object.getPrototypeOf(z));return G}function Lz(z){var G=0,K=z.length>0?[z[0]]:[];for(var U=1;U<z.length;U++){if(K[G].type===2&&z[U].type===2){K[G].text+=z[U].text;continue}K[++G]=z[U]}return K}function V(z,G,K,U,Q){if(!K||!G)return!1;if(G.nodeType===3)return!1;if(!P(z,K,U.firstChild(G),U,Q)){if(z)console.warn("[DEBUG_HYDRATE] Could not copy DOM into virtual DOM, falling back to diff");while(U.firstChild(G))Q.removeChild(G,U.lastChild(G));return!1}else if(z)console.info("[DEBUG_HYDRATE] Successfully prerendered page");return!0}function L(z,G,K){if(z)console.warn("[DEBUG_HYDRATE] VTree differed from node",G,K)}function Gz(z){if(z.substr(0,1)=="#"){let G=(z.length-1)/3,K=[17,1,0.062272][G-1];return[Math.round(parseInt(z.substr(1,G),16)*K),Math.round(parseInt(z.substr(1+G,G),16)*K),Math.round(parseInt(z.substr(1+2*G,G),16)*K)]}else return z.split("(")[1].split(")")[0].split(",").map((G)=>{return+G})}function w(z,G,K){return Kz(!0,z,G,K)}function Kz(z,G,K,U){if(G.type==2){if(K.getTag(G.domRef)!=="#text")console.warn("VText domRef not a TEXT_NODE",G),z=!1;else if(G.text!==K.getTextContent(G.domRef))console.warn("VText node content differs",G),z=!1}else if(G.type===1){if(G.tag.toUpperCase()!==K.getTag(G.domRef).toUpperCase())console.warn("Integrity check failed, tags differ",G.tag.toUpperCase(),K.getTag(G.domRef)),z=!1;if("children"in G&&G.children.length!==K.children(G.domRef).length)console.warn("Integrity check failed, children lengths differ",G,G.children,K.children(G.domRef)),z=!1;for(let Q in G.props)if(Q==="href"||Q==="src"){let Y=window.location.origin+"/"+G.props[Q],X=K.getAttribute(G.domRef,Q),$=G.props[Q];if(Y!==X&&$!==X&&$+"/"!==X&&Y+"/"!==X)console.warn("Property "+Q+" differs",G.props[Q],K.getAttribute(G.domRef,Q)),z=!1}else if(Q==="height"||Q==="width"){if(parseFloat(G.props[Q])!==parseFloat(K.getAttribute(G.domRef,Q)))console.warn("Property "+Q+" differs",G.props[Q],K.getAttribute(G.domRef,Q)),z=!1}else if(Q==="class"||Q==="className"){if(G.props[Q]!==K.getAttribute(G.domRef,"class"))console.warn("Property class differs",G.props[Q],K.getAttribute(G.domRef,"class")),z=!1}else if(G.props[Q]!==K.getAttribute(G.domRef,Q))console.warn("Property "+Q+" differs",G.props[Q],K.getAttribute(G.domRef,Q)),z=!1;for(let Q in G.css)if(Q==="color"){if(Gz(K.getInlineStyle(G.domRef,Q)).toString()!==Gz(G.css[Q]).toString())console.warn("Style "+Q+" differs",G.css[Q],K.getInlineStyle(G.domRef,Q)),z=!1}else if(G.css[Q]!==K.getInlineStyle(G.domRef,Q))console.warn("Style "+Q+" differs",G.css[Q],K.getInlineStyle(G.domRef,Q)),z=!1;for(let Q of G.children){let Y=Kz(z,Q,K,U);z=z&&Y}}return z}function P(z,G,K,U,Q){switch(G.type){case 0:if(!P(z,G.child,K,U,Q))return!1;break;case 2:if(K.nodeType!==3||G.text.trim()!==K.textContent.trim())return L(z,G,K),!1;G.domRef=K;break;case 1:if(K.nodeType!==1)return L(z,G,K),!1;G.domRef=K,G.children=Lz(G.children),n(K,G,Q);for(var Y=0;Y<G.children.length;Y++){let X=G.children[Y],$=K.childNodes[Y];if(!$)return L(z,X,$),!1;if(!P(z,X,$,U,Q))return!1}break}return!0}var O="1.9.0.0";function f(z,G){var K=function(){var U=document.getElementById(z);if(U&&U.focus)U.focus()};G>0?setTimeout(K,G):K()}function j(z,G){var K=function(){var U=document.getElementById(z);if(U&&U.blur)U.blur()};G>0?setTimeout(K,G):K()}function b(z,G){var K=function(){var U=document.getElementById(z);if(U&&typeof U.select==="function")U.select()};G>0?setTimeout(K,G):K()}function k(z,G,K,U){var Q=function(){var Y=document.getElementById(z);if(Y&&typeof Y.setSelectionRange==="function")Y.setSelectionRange(G,K,"none")};U>0?setTimeout(Q,U):Q()}function h(z,G,K,U,Q,Y,X){var $={method:G,headers:U};if(K)$.body=K;let H={},q=null;try{fetch(z,$).then((Z)=>{q=Z.status;for(let[_,A]of Z.headers)H[_]=A;if(!Z.ok)throw new Error(Z.statusText);if(X=="json")return Z.json();else if(X=="text")return Z.text();else if(X==="arrayBuffer")return Z.arrayBuffer();else if(X==="blob")return Z.blob();else if(X==="bytes")return Z.bytes();else if(X==="formData")return Z.formData();else if(X==="none")return Q({error:null,body:null,headers:H,status:q})}).then((Z)=>Q({error:null,body:Z,headers:H,status:q})).catch((Z)=>Y({error:null,body:Z,headers:H,status:q}))}catch(Z){Y({body:null,error:Z.message,headers:H,status:q})}}function T(z,G,K,U,Q,Y,X,$,H){try{let q=new WebSocket(z);return q.onopen=function(){G()},q.onclose=function(Z){K(Z)},q.onerror=function(Z){console.error(Z),$("WebSocket error received")},q.onmessage=function(Z){if(typeof Z.data==="string")try{if(H){if(U)U(Z.data);return}let _=JSON.parse(Z.data);if(Q)Q(_)}catch(_){if(H&&U)U(Z.data);else $(_.message)}else if(Z.data instanceof Blob){if(Y)Y(Z.data)}else if(Z.data instanceof ArrayBuffer){if(X)X(Z.data)}else console.error("Received unknown message type from WebSocket",Z),$("Unknown message received from WebSocket")},q}catch(q){$(q.message)}}function m(z){if(z)z.close(),z=null}function g(z,G){if(G&&z&&z.readyState===WebSocket.OPEN)z.send(G)}function y(z,G,K,U,Q,Y){try{let X=new EventSource(z);return X.onopen=function(){G()},X.onerror=function(){Q("EventSource error received")},X.onmessage=function($){try{if(Y){if(K)K($.data);return}let H=JSON.parse($.data);if(U)U(H)}catch(H){if(Y&&K)K($.data);else Q(H.message)}},X}catch(X){Q(X.message)}}function u(z){if(z)z.close(),z=null}function v(z,G){if(!z.classList)z.classList=new Set;for(let K of G)for(let U of K.trim().split(" "))if(U)z.classList.add(U)}function l(z,G){if(!z.parent)return;G.nextSibling=z.nextSibling?null:z.nextSibling,G.parent=z.parent,z.parent.child=G}function i(z,G={}){let K=Object.keys(G),U=Object.values(G);return new Function(...K,z)(...U)}function x(z){if(z===null||z===void 0)return 0;if(typeof z==="number")return 1;if(typeof z==="string")return 2;if(typeof z==="boolean")return 3;if(Array.isArray(z))return 4;return 5}function p(z){return function(){z|=0,z=z+2654435769|0;var G=z^z>>>15;return G=Math.imul(G,2246822507),G=G^G>>>13,G=Math.imul(G,3266489909),((G^G>>>16)>>>0)/4294967296}}function d(){let z=new Uint32Array(1);return crypto.getRandomValues(z)[0]}function a(){return Math.random()}var s={addEventListener:(z,G,K,U)=>{z.addEventListener(G,K,U)},delegator:(z,G,K,U,Q)=>{zz(z,G,K,U,Q)},isEqual:(z,G)=>{return z===G},getTarget:(z)=>{return z.target},parentNode:(z)=>{return z.parentNode}},Qz={getInlineStyle:(z,G)=>{return z.style[G]},firstChild:(z)=>{return z.firstChild},lastChild:(z)=>{return z.lastChild},getAttribute:(z,G)=>{if(G==="class")return z.className;if(G in z)return z[G];return z.getAttribute(G)},getTag:(z)=>{return z.nodeName},getTextContent:(z)=>{return z.textContent},children:(z)=>{return z.childNodes}},Uz={mountComponent:function(z,G,K){return},unmountComponent:function(z){return},modelHydration:function(z){return}},Xz={nextSibling:(z)=>{if(z.nextSibling)switch(z.nextSibling.type){case 0:return M(z.nextSibling);default:return z.nextSibling.domRef}return null},createTextNode:(z)=>{return document.createTextNode(z)},createElementNS:(z,G)=>{return document.createElementNS(z,G)},appendChild:(z,G)=>{return z.appendChild(G)},replaceChild:(z,G,K)=>{return z.replaceChild(G,K)},removeChild:(z,G)=>{return z.removeChild(G)},createElement:(z)=>{return document.createElement(z)},addClass:(z,G)=>{if(z)G.classList.add(z)},removeClass:(z,G)=>{if(z)G.classList.remove(z)},insertBefore:(z,G,K)=>{return z.insertBefore(G,K)},swapDOMRefs:(z,G,K)=>{let U=z.nextSibling;K.insertBefore(z,G),K.insertBefore(G,U);return},setInlineStyle:(z,G,K)=>{var U;for(let Q in z)if(U=G[Q],!U)if(Q in K.style)K.style[Q]="";else K.style.setProperty(Q,"");else if(U!==z[Q])if(Q in K.style)K.style[Q]=U;else K.style.setProperty(Q,U);for(let Q in G){if(z&&z[Q])continue;if(Q in K.style)K.style[Q]=G[Q];else K.style.setProperty(Q,G[Q])}return},setAttribute:(z,G,K)=>{return z.setAttribute(G,K)},setAttributeNS:(z,G,K,U)=>{return z.setAttributeNS(G,K,U)},removeAttribute:(z,G)=>{return z.removeAttribute(G)},setTextContent:(z,G)=>{z.textContent=G;return},flush:()=>{return},getHead:function(){return document.head},getRoot:function(){return document.body}};globalThis.miso={hydrationContext:Qz,eventContext:s,drawingContext:Xz,componentContext:Uz,diff:W,hydrate:V,version:O,callBlur:j,callFocus:f,callSelect:b,callSetSelectionRange:k,eventJSON:B,fetchCore:h,eventSourceConnect:y,eventSourceClose:u,websocketConnect:T,websocketClose:m,websocketSend:g,updateRef:l,inline:i,typeOf:x,mathRandom:a,getRandomValues:d,splitmix32:p,populateClass:v,integrityCheck:w,delegateEvent:E,delegator:s.delegator,setDrawingContext:function(z){let G=globalThis[z].drawingContext,K=globalThis[z].eventContext;if(!G)console.error('Custom rendering engine ("drawingContext") is not defined at globalThis[name].drawingContext',z);if(!K)console.error('Custom event delegation ("eventContext") is not defined at globalThis[name].eventContext',z);globalThis.miso.drawingContext=G,globalThis.miso.eventContext=K}};
